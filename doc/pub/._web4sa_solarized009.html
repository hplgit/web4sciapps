<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Using Web Frameworks for Scientific Applications">
<meta name="keywords" content="web frameworks,MVC pattern,Flask installation,Flask input forms,Flask HTML templates,Flask MVC pattern,Flask troubleshooting,Django installation,Django making a project,Django making an application,Django input forms,Django HTML templates,Flask input forms,Flask error checking,Flask CSS style sheets,Flask LaTeX mathematics,Flask input validation,inline PNG image in HTML,base64 encoding of PNG images,inline SVG figure in HTML,mpld3 plotting,Flask Bokeh plotting,Bokeh plotting,highcharts,Flask login,Flask database,Flask uploading of files,Flask file upload,Django input forms,Django input validation">

<title>Using Web Frameworks for Scientific Applications</title>


<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
code { padding: 0px; background-color: inherit; }
pre {
  border: 0pt solid #93a1a1;
  box-shadow: none;
}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Web frameworks', 1, None, '___sec0'),
              ('The MVC pattern', 2, None, '___sec1'),
              ('A very simple application', 2, None, '___sec2'),
              ('Application of the MVC pattern', 2, 'wf:hw:mvc', 'wf:hw:mvc'),
              ('Making a Flask application', 1, None, '___sec4'),
              ('Programming the Flask application', 2, None, '___sec5'),
              ('The user interaction', 3, None, '___sec6'),
              ('The Python code', 3, None, '___sec7'),
              ('Dissection', 3, None, '___sec8'),
              ('The template files', 3, None, '___sec9'),
              ('Testing the application', 3, None, '___sec10'),
              ('Equipping the input page with output results',
               2,
               None,
               '___sec11'),
              ('Splitting the app into model, view, and controller files',
               2,
               'wf:hw3:flask',
               'wf:hw3:flask'),
              ('Troubleshooting', 2, None, '___sec13'),
              ('Address already in use', 3, None, '___sec14'),
              ('Making a Django application', 1, None, '___sec15'),
              ('Setting up a Django project', 2, None, '___sec16'),
              ('Setting up a Django application', 2, None, '___sec17'),
              ('Programming the Django application', 2, None, '___sec18'),
              ('The user interaction', 3, None, '___sec19'),
              ('The model', 3, None, '___sec20'),
              ('The view', 3, None, '___sec21'),
              ('Making the input page', 3, None, '___sec22'),
              ('Making the results page', 3, None, '___sec23'),
              ('Equipping the input page with output results',
               2,
               None,
               '___sec24'),
              ('Handling multiple input variables in Flask',
               1,
               'wf:vib:flask',
               'wf:vib:flask'),
              ('Programming the Flask application',
               2,
               'wf:vib1:flask:app',
               'wf:vib1:flask:app'),
              ('The compute part', 3, None, '___sec27'),
              ('The model', 3, None, '___sec28'),
              ('The view', 3, None, '___sec29'),
              ('The HTML template', 3, None, '___sec30'),
              ('Implementing error checking in the template',
               2,
               None,
               '___sec31'),
              ('Using style sheets', 2, None, '___sec32'),
              ('Using LaTeX mathematics', 2, None, '___sec33'),
              ('Rearranging the elements in the HTML template',
               2,
               None,
               '___sec34'),
              ('Bootstrap HTML style', 2, None, '___sec35'),
              ('Custom validation',
               2,
               'wf:vib1:flask:validation',
               'wf:vib1:flask:validation'),
              ('Using Flask validators', 3, None, '___sec37'),
              ('Tailored validation', 3, None, '___sec38'),
              ('Tailored validation of intervals', 3, None, '___sec39'),
              ('Demo', 3, None, '___sec40'),
              ('Avoiding plot files',
               2,
               'wf:vib2:flask:nofiles',
               'wf:vib2:flask:nofiles'),
              ('PNG plots', 3, None, '___sec42'),
              ('SVG plots', 3, None, '___sec43'),
              ('Using mpld3', 3, None, '___sec44'),
              ('Plotting with the Bokeh library',
               2,
               'wf:bokeh:flask',
               'wf:bokeh:flask'),
              ('Pandas highcharts plotting library', 3, None, '___sec46'),
              ('Autogenerating the code',
               2,
               'wf:autogen:flask',
               'wf:autogen:flask'),
              ('Inspecting function signatures', 3, None, '___sec48'),
              ('Generating the model', 3, None, '___sec49'),
              ('Generating the view', 3, None, '___sec50'),
              ('Generating the template', 3, None, '___sec51'),
              ('Application', 3, None, '___sec52'),
              ('User login and storage of computed results',
               2,
               'wf:flask:login',
               'wf:flask:login'),
              ('Required additional software', 3, None, '___sec54'),
              ('The compute part', 3, None, '___sec55'),
              ('The interfaces of the app', 3, None, '___sec56'),
              ('The source code', 3, None, '___sec57'),
              ('Resources', 3, None, '___sec58'),
              ('Uploading of files', 2, 'wf:flask:upload', 'wf:flask:upload'),
              ('Overview of the application', 3, None, '___sec60'),
              ('The model class', 3, None, '___sec61'),
              ('The controller file', 3, None, '___sec62'),
              ('The compute function', 3, None, '___sec63'),
              ('The HTML template', 3, None, '___sec64'),
              ('Handling multiple input variables in Django',
               1,
               'wf:vib:django',
               'wf:vib:django'),
              ('Programming the Django application', 2, None, '___sec66'),
              ('Adding the app to a project', 3, None, '___sec67'),
              ('The compute part', 3, None, '___sec68'),
              ('The model', 3, None, '___sec69'),
              ('The view', 3, None, '___sec70'),
              ('Custom validation', 2, None, '___sec71'),
              ('Customizing widgets', 2, None, '___sec72'),
              ('Resources', 2, None, '___sec73'),
              ('Exercises', 1, None, '___sec74'),
              ('Exercise 1: Add two numbers',
               2,
               'wf:exer:add2',
               'wf:exer:add2'),
              ('Exercise 2: Upload data file and visualize curves',
               2,
               'wf:exer:upload',
               'wf:exer:upload'),
              ('Exercise 3: Plot a user-specified formula',
               2,
               'wf:exer:formula',
               'wf:exer:formula'),
              ('Exercise 4: Visualize Taylor polynomial approximations',
               2,
               'wf:exer:Taylor',
               'wf:exer:Taylor'),
              ('Exercise 5: Extend the `gen` app',
               2,
               'wf:exer:gen:demo',
               'wf:exer:gen:demo'),
              ('Exercise 6: Equip the `gen` app with more data types',
               2,
               'wf:exer:gen:lists',
               'wf:exer:gen:lists'),
              ('Exercise 7: Auto-generate code from function signature',
               2,
               None,
               '___sec81'),
              ('Project 8: Interactive function exploration',
               2,
               'wf:exer:bokeh_UI',
               'wf:exer:bokeh_UI'),
              ('Resources', 1, None, '___sec83'),
              ('Flask resources', 2, None, '___sec84'),
              ('Django resources', 2, None, '___sec85')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<a name="part0009"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._web4sa_solarized008.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._web4sa_solarized010.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->

<h2 id="___sec31">Implementing error checking in the template </h2>

<p>
What happens if the user gives wrong input, for instance the letters <code>asd</code>
instead of a number? Actually nothing! The <code>FloatField</code> object
checks that the input is compatible with a real number in the
<code>form.validate()</code> call, but returns just <code>False</code> if this is not
the case. Looking at the code in <code>controller.py</code>,

<p>
<!-- begin verbatim block  pycod-->
<pre><code>def index():
    form = InputForm(request.form)
    if request.method == 'POST' and form.validate():
        result = compute(form.A.data, form.b.data,
                         form.w.data, form.T.data)
    else:
        result = None
</code></pre>
<!-- end verbatim block -->
we realize that wrong input implies <code>result = None</code> and no computations
and no plot! Fortunately, each field object gets an attribute <code>error</code>
with information on errors that occur on input. We can write out
this information on the web page, as exemplified in the template
<code>view_errcheck.html</code>:

<p>
<!-- begin verbatim block  htmlpro-->
<pre><code>&lt;form method=post action=&quot;&quot;&gt;
&lt;table&gt;
  {% for field in form %}
    &lt;tr&gt;
    &lt;td&gt;{{ field.name }}&lt;/td&gt;&lt;td&gt;{{ field(size=12) }}&lt;/td&gt;
    &lt;td&gt;{{ field.label }}&lt;/td&gt;
    {% if field.errors %}
      &lt;td&gt;&lt;ul class=errors&gt;
      {% for error in field.errors %}
        &lt;li&gt;&lt;font color=&quot;red&quot;&gt;{{ error }}&lt;/font&gt;&lt;/li&gt;
      {% endfor %}&lt;/ul&gt;&lt;/td&gt;
    {% endif %}
    &lt;/tr&gt;
  {% endfor %}
&lt;/table&gt;
&lt;p&gt;&lt;input type=submit value=Compute&gt;&lt;/form&gt;&lt;/p&gt;
&lt;p&gt;
{% if result != None %}
&lt;img src=&quot;{{ result }}&quot; width=&quot;500&quot;&gt;
{% endif %}
&lt;/p&gt;
</code></pre>
<!-- end verbatim block -->
Two things are worth noticing here:

<ol>
<li> We can control the width of the text field where the
   user writes the numbers, here set to 12 characters.</li>
<li> We can make an extra column in the HTML table with a list
   of possible errors for each field object.</li>
</ol>

Let us test the error handling of the <code>A</code> field by
writing <code>asd</code> instead of a number. This input
triggers an error, whose message is written in red to the right of the label,
see Figure <a href="#wf:vib1:flask:fig:error1">9</a>.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 9:  Error message because of wrong input. <div id="wf:vib1:flask:fig:error1"></div> </p></center>
<p><img src="fig-web4sa/vib1_flask_error1.png" align="bottom" width=500></p>
</center>

<p>
It is possible to use the additional HTML5 fields for input in a Flask
context. Instead of explaining how here, we recommend to use the
<a href="https://github.com/hplgit/parampool" target="_self">Parampool</a>
package to automatically generate Flask files with HTML5 fields.

<p>
<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._web4sa_solarized008.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._web4sa_solarized010.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

