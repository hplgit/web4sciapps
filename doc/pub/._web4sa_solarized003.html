<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Using Web Frameworks for Scientific Applications">
<meta name="keywords" content="web frameworks,MVC pattern,Flask installation,Flask input forms,Flask HTML templates,Flask MVC pattern,Flask troubleshooting,Django installation,Django making a project,Django making an application,Django input forms,Django HTML templates,Flask input forms,Flask error checking,Flask CSS style sheets,Flask LaTeX mathematics,Flask input validation,inline PNG image in HTML,base64 encoding of PNG images,inline SVG figure in HTML,Flask login,Flask database,Flask uploading of files,Flask file upload,Django input forms,Django input validation">

<title>Using Web Frameworks for Scientific Applications</title>


<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
code { padding: 0px; background-color: inherit; }
pre {
  border: 0pt solid #93a1a1;
  box-shadow: none;
}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Web frameworks ', 1, None, '___sec0'),
              (' The MVC pattern ', 2, None, '___sec1'),
              (' A very simple application ', 2, None, '___sec2'),
              (' Application of the MVC pattern ',
               2,
               'wf:hw:mvc',
               'wf:hw:mvc'),
              (' Making a Flask application ', 1, None, '___sec4'),
              (' Programming the Flask application ', 2, None, '___sec5'),
              (' The user interaction ', 3, None, '___sec6'),
              (' The Python code ', 3, None, '___sec7'),
              (' Dissection ', 3, None, '___sec8'),
              (' The template files ', 3, None, '___sec9'),
              (' Testing the application ', 3, None, '___sec10'),
              (' Equipping the input page with output results ',
               2,
               None,
               '___sec11'),
              (' Splitting the app into model, view, and controller files ',
               2,
               'wf:hw3:flask',
               'wf:hw3:flask'),
              (' Troubleshooting ', 2, None, '___sec13'),
              (' Address already in use ', 3, None, '___sec14'),
              (' Making a Django application ', 1, None, '___sec15'),
              (' Setting up a Django project ', 2, None, '___sec16'),
              (' Setting up a Django application ', 2, None, '___sec17'),
              (' Programming the Django application ', 2, None, '___sec18'),
              (' The user interaction ', 3, None, '___sec19'),
              (' The model ', 3, None, '___sec20'),
              (' The view ', 3, None, '___sec21'),
              (' Making the input page ', 3, None, '___sec22'),
              (' Making the results page ', 3, None, '___sec23'),
              (' Equipping the input page with output results ',
               2,
               None,
               '___sec24'),
              (' Handling multiple input variables in Flask ',
               1,
               'wf:vib:flask',
               'wf:vib:flask'),
              (' Programming the Flask application ',
               2,
               'wf:vib1:flask:app',
               'wf:vib1:flask:app'),
              (' The compute part ', 3, None, '___sec27'),
              (' The model ', 3, None, '___sec28'),
              (' The view ', 3, None, '___sec29'),
              (' The HTML template ', 3, None, '___sec30'),
              (' Implementing error checking in the template ',
               2,
               None,
               '___sec31'),
              (' Using style sheets ', 2, None, '___sec32'),
              (' Using LaTeX mathematics ', 2, None, '___sec33'),
              (' Rearranging the elements in the HTML template ',
               2,
               None,
               '___sec34'),
              (' Bootstrap HTML style ', 2, None, '___sec35'),
              (' Custom validation ',
               2,
               'wf:vib1:flask:validation',
               'wf:vib1:flask:validation'),
              (' Using Flask validators ', 3, None, '___sec37'),
              (' Tailored validation ', 3, None, '___sec38'),
              (' Tailored validation of intervals ', 3, None, '___sec39'),
              (' Demo ', 3, None, '___sec40'),
              (' Avoiding plot files ',
               2,
               'wf:vib2:flask:nofiles',
               'wf:vib2:flask:nofiles'),
              (' PNG plots ', 3, None, '___sec42'),
              (' SVG plots ', 3, None, '___sec43'),
              (' Autogenerating the code ',
               2,
               'wf:autogen:flask',
               'wf:autogen:flask'),
              (' Inspecting function signatures ', 3, None, '___sec45'),
              (' Generating the model ', 3, None, '___sec46'),
              (' Generating the view ', 3, None, '___sec47'),
              (' Generating the template ', 3, None, '___sec48'),
              (' Application ', 3, None, '___sec49'),
              (' User login and storage of computed results ',
               2,
               'wf:flask:login',
               'wf:flask:login'),
              (' Required additional software ', 3, None, '___sec51'),
              (' The compute part ', 3, None, '___sec52'),
              (' The interfaces of the app ', 3, None, '___sec53'),
              (' The source code ', 3, None, '___sec54'),
              (' Resources ', 3, None, '___sec55'),
              (' Uploading of files ',
               2,
               'wf:flask:upload',
               'wf:flask:upload'),
              (' Overview of the application ', 3, None, '___sec57'),
              (' The model class ', 3, None, '___sec58'),
              (' The controller file ', 3, None, '___sec59'),
              (' The compute function ', 3, None, '___sec60'),
              (' The HTML template ', 3, None, '___sec61'),
              (' Handling multiple input variables in Django ',
               1,
               'wf:vib:django',
               'wf:vib:django'),
              (' Programming the Django application ', 2, None, '___sec63'),
              (' Adding the app to a project ', 3, None, '___sec64'),
              (' The compute part ', 3, None, '___sec65'),
              (' The model ', 3, None, '___sec66'),
              (' The view ', 3, None, '___sec67'),
              (' Custom validation ', 2, None, '___sec68'),
              (' Customizing widgets ', 2, None, '___sec69'),
              (' Resources ', 2, None, '___sec70'),
              (' Exercises ', 1, None, '___sec71'),
              (' Exercise 1: Add two numbers ',
               2,
               'wf:exer:add2',
               'wf:exer:add2'),
              (' Exercise 2: Upload data file and visualize curves ',
               2,
               'wf:exer:upload',
               'wf:exer:upload'),
              (' Exercise 3: Plot a user-specified formula ',
               2,
               'wf:exer:formula',
               'wf:exer:formula'),
              (' Exercise 4: Visualize Taylor polynomial approximations ',
               2,
               'wf:exer:Taylor',
               'wf:exer:Taylor'),
              (' Exercise 5: Extend the `gen` app ',
               2,
               'wf:exer:gen:demo',
               'wf:exer:gen:demo'),
              (' Exercise 6: Equip the `gen` app with more data types ',
               2,
               'wf:exer:gen:lists',
               'wf:exer:gen:lists'),
              (' Exercise 7: Auto-generate code from function signature ',
               2,
               None,
               '___sec78'),
              (' Resources ', 1, None, '___sec79'),
              (' Flask resources ', 2, None, '___sec80'),
              (' Django resources ', 2, None, '___sec81'),
              (' Remaining ', 1, None, '___sec82')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<a name="part0003"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._web4sa_solarized002.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._web4sa_solarized004.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->

<h2 id="wf:hw:mvc">Application of the MVC pattern</h2>

<p>
Before thinking of a web application, we first <em>refactor</em> our program
such that it fits with the classical MVC pattern and a compute component.
The refactoring does not change the functionality of the code, it
just distributes the original statements in functions and modules.
Here we create four modules: <code>model</code>, <code>view</code>,
<code>compute</code>, and <code>controller</code>.

<ul>
 <li> The <code>compute</code> module contains a function <code>compute(r)</code> that performs
   the mathematics and returns the value <code>s</code>, which equals <code>sin(r)</code>.</li>
 <li> The <code>model</code> module holds the input data, here <code>r</code>.</li>
 <li> The <code>view</code> module has two functions, one for reading input data,
   <code>get_input</code>,
   and one for presenting the output, <code>present_output</code>.
   The latter takes the input, calls <code>compute</code> functionalty, and
   generates the output.</li>
 <li> The <code>controller</code> module calls the view to initialize
   the model's data from the command line. Thereafter, the
   view is called to present the output.</li>
</ul>

The <code>model.py</code> file contains the <code>r</code> variable, which must
be declared with a default value in order to create the data object:

<p>
<!-- begin verbatim block  pypro-->
<pre><code>r = 0.0    # input
s = None   # output
</code></pre>
<!-- end verbatim block -->

<p>
The <code>view.py</code> file is restricted to the communication with the user and reads

<p>
<!-- begin verbatim block  pypro-->
<pre><code>import sys
import compute

# Input: float r
# Output: &quot;Hello, World! sin(r)=...&quot;

def get_input():
    &quot;&quot;&quot;Get input data from the command line.&quot;&quot;&quot;
    r = float(sys.argv[1])
    return r

def present_output(r):
    &quot;&quot;&quot;Write results to terminal window.&quot;&quot;&quot;
    s = compute.compute(r)
    print 'Hello, World! sin(%g)=%g' % (r, s)
</code></pre>
<!-- end verbatim block -->

<p>
The mathematics is encapsulated in <code>compute.py</code>:

<p>
<!-- begin verbatim block  pypro-->
<pre><code>import math

def compute(r):
    return math.sin(r)
</code></pre>
<!-- end verbatim block -->

<p>
Finally, <code>controller.py</code> glues the model and the view:

<p>
<!-- begin verbatim block  pypro-->
<pre><code>import model, view

model.r = view.get_input()
view.present_output(model.r)
</code></pre>
<!-- end verbatim block -->

<p>
Let us try our refactored code:

<p>
<!-- begin verbatim block  sys-->
<pre><code>Terminal&gt; python controller.py 1.2
Hello, World! sin(1.2)=0.932039
</code></pre>
<!-- end verbatim block -->

<p>
The next step is to create a web interface to our scientific hello world
program such that we can fill in the number <code>r</code> in a text field, click a
<em>Compute</em> button and get back a new web page with the output text
shown above: "Hello, World! sin(r)=s".

<p>
<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._web4sa_solarized002.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._web4sa_solarized004.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

